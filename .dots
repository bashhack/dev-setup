#!/bin/bash

function runDots() {
  # Ask for admin password
  sudo -v

  # Keep-alive: update existing `sudo` time stamp until the script is done
  while true; do sudo -n true; sleep 60; kill -0 "$$" || exit; done 2>/dev/null &

  # Run setions based on command line arguments
  for ARG in "$@"
  do
    if [ $ARG == "bootstrap" ] || [ $ARG == "all" ]; then
      echo ""
      echo "-------------------------------"
      echo "Syncing the dev-setup repo to your local machine."
      echo "-------------------------------"
      echo ""
      cd ~ && curl -#L https://github.com/bashhack/dev-setup/tarball/master | tar -xzv --strip-components 1 --exclude={README.rst,LICENSE,bootstrap.sh}
    fi
  done

  echo "-------------------------------"
  echo "Completed running .dots, restart your computer to ensure all updates take effect"
  echo "-------------------------------"
}    

read -p "This script may overwrite existing files in your home directory. Are you sure? (y/n) " -n 1;
echo "";
if [[ $REPLY =~ ^[Yy]$ ]]; then
  runDots $@
fi;

unset runDots;
